{"version":3,"file":"urql-exchange-auth.mjs","sources":["../src/authExchange.ts"],"sourcesContent":null,"names":["addAuthAttemptToOperation","operation","authAttempt","makeOperation","kind","context","authExchange","init","client","forward","bypassQueue","Set","retries","makeSubject","errors","retryQueue","Map","flushQueue","authPromise","undefined","queue","forEach","next","errorQueue","error","makeErrorResult","config","operations$","initAuth","Promise","resolve","then","mutate","query","variables","baseOperation","createRequestOperation","createRequest","toPromise","take","filter","result","key","_instance","onStart","addAuthToOperation","add","result$","appendHeaders","headers","fetchOptions","_config","catch","process","env","NODE_ENV","console","warn","refreshAuth","set","opsWithAuth$","Boolean","map","delete","has","willAuthError","merge","source","didAuthError"],"mappings":"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"}