{"version":3,"file":"urql-exchange-graphcache-default-storage.mjs","sources":["../src/default-storage/index.ts"],"sourcesContent":null,"names":["getRequestPromise","request","Promise","resolve","reject","onerror","error","onsuccess","result","getTransactionPromise","transaction","oncomplete","makeDefaultStorage","opts","callback","DB_NAME","idbName","ENTRIES_STORE_NAME","METADATA_STORE_NAME","batch","Object","create","timestamp","Math","floor","Date","valueOf","maxAge","req","indexedDB","open","database$","onupgradeneeded","createObjectStore","serializeEntry","entry","replace","deserializeEntry","deserializeBatch","input","data","char","key","mode","index","length","undefined","clear","then","database","objectStore","readMetadata","get","writeMetadata","metadata","put","writeData","entries","assign","toUndefined","serializeBatch","value","readData","chunks","store","openKeyCursor","openCursor","call","this","delete","push","continue","join","onCacheHydrated","onOnline","cb","window","removeEventListener","addEventListener"],"mappings":"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"}